# Parallel runs with MPI

To compile with MPI parallelism enabled, you need to use something like:

~~~bash
CC99='mpicc -std=c99' qcc -Wall -O2 -D_MPI=1 example.c -o example -lm
~~~

where *mpicc* calls the MPI compiler on your system. The resulting
executable can then be run in parallel using something like

~~~bash
mpirun -np 8 ./example
~~~

The details may vary according to how the MPI compiler is setup on
your system.

## Using Makefiles

The "manual" way above is automated if you use the [standard
Makefiles](/Tutorial#using-makefiles) provided by Basilisk. You can
then compile and run the example above on eight processes using:

~~~bash
CC='mpicc -D_MPI=8' make example.tst
~~~

This assumes that *mpicc* and *mpirun* are available on your system.

## Running on supercomputers

A simple way to run Basilisk code on a supercomputer is to first
generate a portable (ISO C99) source code on a machine where *qcc* is
installed i.e.

~~~bash
%localmachine: qcc -source -D_MPI=1 example.c
~~~

Then copy the portable source code *_example.c* (don't forget the
underscore!) on the supercomputer and compile it:

~~~bash
%localmachine: scp _example.c login@supercomputer.org:
%localmachine: ssh login@supercomputer.org
%supercomputer.org: mpicc -Wall -std=c99 -O2 -D_MPI=1 _example.c -o example -lm
~~~

where the *-std=c99* option sets the version of the language to C99. Note that 
this option may change depending on the compiler (the options shown above are 
valid for *gcc* or *icc*, the Intel compiler).

You will then need to use the job submission system of the
supercomputer to set the number of processes and run the
executable. See also the following examples:

* [Parallel scalability](test/mpi-laplacian.c#how-to-run-on-occigen)
* [Atomisation of a pulsed liquid jet](examples/atomisation.c#running-in-parallel)
* [Forced isotropic turbulence in a triply-periodic box](examples/isotropic.c#running-with-mpi-on-occigen)
